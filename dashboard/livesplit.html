<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
	<style>
		.monospace {
			font-family: monospace;
		}
	</style>
</head>
<body>
	<div>
		<div>
			<span>Status: </span><span id="connection-status"></span>
		</div>
		<div>
			<button id="btn-connect"></button>
		</div>
		<br />
		<div id="timer-info">
			<span>Current Timer Phase: </span><span id="currentTimerPhase"></span><br />
			<span>Total Delta: </span><span id="delta"></span><br />
			<span>Last Split Time: </span><span id="lastSplitTime"></span><br />
			<span>Comparison Split Time: </span><span id="comparisonSplitTime"></span><br />
			<span>Current Time: </span><span id="currentTime"></span><br />
			<span>Final Time: </span><span id="finalTime"></span><br />
			<span>PredictedTime: </span><span id="predictedTime"></span><br />
			<span>BestPossibleTime: </span><span id="bestPossibleTime"></span><br />
			<span>Split Index: </span><span id="splitIndex"></span><br />
			<span>Current Split Name: </span><span id="currentSplitName"></span><br />
			<span>Previous Split Name: </span><span id="previousSplitname"></span><br />
		</div>
	</div>
	<script>
		const rLivesplit = nodecg.Replicant('livesplit')
		const button = document.getElementById('btn-connect')

		rLivesplit.on('change', (newValue, oldValue) => {
			const connStatus = newValue.connection.status
			if (connStatus === 'connected') {
				button.innerText = 'Disconnect'
			} else {
				button.innerText = 'Connect'
			}
			document.getElementById('connection-status').textContent = `${connStatus.charAt(0).toUpperCase()}${connStatus.slice(1)} ${connStatus === 'connected' ? 'to' : 'from'} LiveSplit`

			if (newValue.timer) {
				Object.keys(newValue.timer).forEach( key => {
					document.getElementById(key).textContent = newValue.timer[key]
				})
				document.getElementById('timer-info').style.display = 'block'
			} else {
				document.getElementById('timer-info').style.display = 'none'
			}
		})

		button.onclick = (ev) => {
			if (button.innerText === 'Connect') {
				nodecg.sendMessage('connect')
			} else {
				nodecg.sendMessage('disconnect')
			}
		}
	</script>
</body>
</html>
